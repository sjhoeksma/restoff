(function(){"use strict";function e(e){var r=Object.create(t.prototype);return r._isOnline=r.ONLINE_UNKNOWN,r._forcedOffline=!1,r._repo={},e?r._rootUri=e.rootUri?e.rootUri:"":r._rootUri="",r}function t(){}var r=this,o=r.restlib||{};o["version-library"]="0.0.8","undefined"!=typeof module&&module.exports?module.exports=o:r.restlib=o,t.prototype=Object.create(Object.prototype,{rootUri:{get:function(){return this._rootUri},set:function(e){this._rootUri=e}},isForcedOffline:{get:function(){return this._forcedOffline}},forceOffline:{set:function(e){this._forcedOffline=!0,this._isOnline=this.ONLINE_NOT}},repository:{get:function(){return this._repo}},isOnline:{get:function(){return this._isOnline},set:function(e){this._isOnline=e}},getRequest:{get:function(){var e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return this.isForcedOffline?(e.__defineGetter__("readyState2",function(){return e.__proto__.DONE}),e.send=function(){this.onreadystatechange()}):e.__defineGetter__("readyState2",function(){return this.readyState}),e}}}),t.prototype.ONLINE_UNKNOWN=10,t.prototype.ONLINE=11,t.prototype.ONLINE_NOT=12,t.prototype.repoNameFrom=function(e){var t=document.createElement("a");t.href=e;var r=t.pathname.replace(this.rootUri,"");return"/"==r[0]&&(r=r.slice(1,r.length)),r},t.prototype.repoAdd=function(e,t){var r=this.repoNameFrom(e);return this._repo[r]=JSON.parse(t),this._repo[r]},t.prototype.get=function(e){var t=this,r=new Promise(function(r,o){var n=t.getRequest;n.open("GET",e,!0),n.onreadystatechange=function(){if(n.__proto__.DONE===n.readyState2)if(n.__proto__.UNSENT===n.status){t.isOnline=t.ONLINE_NOT;var i=t.repoNameFrom(e);void 0===t.repository[i]&&t.repoAdd(e,"{}"),r(t.repository[i])}else if(200===n.status)t.isOnline=t.ONLINE,r(t.repoAdd(e,n.response));else{var s={message:n.statusText,messageDetail:n.responseText.replace(/\r?\n|\r/g,""),status:n.status};o(s)}},n.send()});return r},o.restoff=e}).call(this);