(function(){"use strict";function e(e){var r=Object.create(t.prototype);return r._isOnline=!1,r._forcedOffline=!1,r._repo={},e?r._rootUri=e.rootUri?e.rootUri:"":r._rootUri="",r}function t(){}var r=this,n=r.restlib||{};n["version-library"]="0.0.7","undefined"!=typeof module&&module.exports?module.exports=n:r.restlib=n,t.prototype=Object.create(Object.prototype,{rootUri:{get:function(){return this._rootUri},set:function(e){this._rootUri=e}},isForcedOffline:{get:function(){return this._forcedOffline}},forcedOffline:{set:function(e){this._forcedOffline=!0,this._isOnline=!1}},repository:{get:function(){return this._repo}},isOnline:{get:function(){return this._isOnline},set:function(e){this._isOnline=e}},getRequest:{get:function(){var e=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");return this.isForcedOffline?(e.__defineGetter__("readyState2",function(){return e.__proto__.DONE}),e.send=function(){this.onreadystatechange()}):e.__defineGetter__("readyState2",function(){return this.readyState}),e}}}),t.prototype.repoAdd=function(e,t){var r=document.createElement("a");r.href=e;var n=r.pathname.replace(this.rootUri,"");"/"==n[0]&&(n=n.slice(1,n.length)),this._repo[n]=t},t.prototype.get=function(e){var t=this,r=new Promise(function(r,n){var o=t.getRequest;o.open("GET",e,!0),o.onreadystatechange=function(){if(o.__proto__.DONE==o.readyState2)if(o.__proto__.UNSENT==o.status){var i={offlineData:!0};r(i)}else if(200==o.status)t.isOnline=!0,t.repoAdd(e,o.response),r(JSON.parse(o.response));else{var s={message:o.statusText,messageDetail:o.responseText.replace(/\r?\n|\r/g,""),status:o.status};n(s)}},o.send()});return r},n.restoff=e}).call(this);